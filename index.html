<!-- // ! tab 누르고 아래와 같이 html 템플릿 넣기 // -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>
</html> -->
<!-- // 그러고나서 위와 같이 생기고 나서 body 사이에 teachable machine에서 가져온 자바스크립트 넣기 // -->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>K pop celebe like me</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
        <!-- <link href='./style.css' rel='stylesheet'>  내가 갖고 있는 css 파일과 링크 하려면 이걸 써야함, 2개 중복했더니 깨져서 이상하게 나옴 나중에 수정필요 -->
        <!-- <link rel="stylesheet" href="style.css"> -->
        <!-- One justification for using !important is when working with multiple stylesheets. For example, if we are using the Bootstrap CSS framework and want to override the styles for one specific HTML element, we can use the !important property.
        스타일시트 2개이상 쓸때 맘에 드는거에는 !important 붙여서 사용
        p {
            color: blue !important;
          }
           
          .main p {
            color: red;
          }

        <head>
          <title>The Rise of Soccer in The US</title>
          <link href='style.css' rel='stylesheet'>
          <link href='style-library.css' rel='stylesheet'>
        </head> -->

<!-- Google Search Console 내사이트 인증 -->
<meta name="google-site-verification" content="Bf_r58r-WpZcmaT543nl9OiX3Ey7jIEc7t6UsVzNLYI" />

<!-- 네이버 웹마스터도구 내사이트 인증 -->
<meta name="naver-site-verification" content="f2f81f17a8eb758ba4306e0b5ccc160865eda600" />
        
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<!-- <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-62c6d29221bac9b5"></script>

위에 Addthis(공유 아이콘)이 서비스 종료해서 밑에 sharethis로 대체함 -->
<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=64a41f26ab7cdf00199e8bbc&product=inline-share-buttons&source=platform" async="async"></script>
<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=64a41f26ab7cdf00199e8bbc&product=inline-share-buttons' async='async'></script>
	    
<!-- Favicon 아이콘 -->
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">

      </head>

<!-- // 처음 헤드는 Bootstrap(상단 바), addthis(공유 아이콘)에서 가져온것 // -->

<body>


<!-- // 처음부분은 navigation bar Bootstrap에서 가져온것 // -->

    <nav class="navbar navbar-expand-lg navbar-light nav-distance">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">K-Pop Celeb like me </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Features</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Pricing</a>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled">Disabled</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

<!-- // 이 위 부분은 navigation bar Bootstrap에서 가져온것 // -->
<!-- // 밑에 d-flex justify-content-center라는 부분은 bootstrap이용해서 글자 위치 정렬, 센터나 좌측 오른측 등// -->

<section class ="section">
    <h3 class="title d-flex justify-content-center">Taehyeon, who do I look like?</h3>
    <h4 class="subtitle d-flex justify-content-center">Well, you look like..</h4>
</section>

<section class="insta">
    <div class="container mt-5 insta-cover d-flex flex-row-reverse mb-5">
        <img src="instagram-icon.jpg" alt="" class="insta-icon">
        <a href="https://www.instagram.com/taehyeon_anchubby/" class="insta-link"> by taehyeon_anchubby </a>
    </div>
</section>



<!-- <button type="button" onclick="init()">Start to add image</button>
<button type="button" onclick="predict()">Predict</button> -->

<!-- // codepen에서 가져온것 아래 -->

<div class="row">
    <div class="small-12 medium-2 large-2 columns">
      <div class="circle">
        <img class="container profile-pic" id="face-image" src="https://t3.ftcdn.net/jpg/03/46/83/96/360_F_346839683_6nAPzbhpSkIpb8pmAwufkC7c5eD7wYws.jpg">
       </div>

       <!-- // result-message와 laber-container를 중간에 끼워넣음 -->
       <p class="result-message"></p>
       <div id="label-container"></div>
       <!-- <div id="label-container" style="display: none;"></div> -->
       <!-- display: none을 하게 되면 중간에 누구를 얼마나 닮았는지는 표시안함 -->

      
       <!-- // 공유 아이콘 위치 -->
                <!-- Go to www.addthis.com/dashboard to customize your tools -->
                <!-- <div class="addthis_inline_share_toolbox"></div> -->
                <!-- 위에는 addthis로 서비스 종료하여 밑에 sharethis로 대체 -->
                <div class="sharethis-inline-share-buttons"></div>


       <div class="p-image">
        <i class="fa fa-camera upload-button"></i>
         <input class="file-upload" type="file" accept="image/*"/>
      </div>
   </div>
 </div>

<!-- // codepen에서 가져온것 위 -->

<div id="webcam-container"></div>


<!-- // Disqus에서 가져온거 안되길래 Livere에서 가져옴, 댓글창 구현 아래 -->

<!-- LiveRe City install code -->
<!-- <div id="lv-container" data-id="city" data-uid="MTAyMC81Njc1NC8zMzIxOA==">
	<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
	</script>
<noscript> Please activate JavaScript for write a comment in LiveRe</noscript>
</div> -->
<!-- completed City install code -->

<!-- // Disqus에서 안되길래 Livere에서 가져옴, 댓글창 구현 위 -->






<!-- // bootstrap에서 가져온것 popper 기능 (drop down 등) 포함된 자바스크립트 // -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

<!-- // teachablemachine을 위한 자바스크립트 // -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

<!-- 별도 추가 Uncaught ReferenceError: $ is not defined 에러 해결하고자 구글링 해서 jquery라이브러리 추가 -->
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>


<!-- //codepen 가져온것 아래 -->
<script>

$(document).ready(function() {

    
var readURL = function(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('.profile-pic').attr('src', e.target.result);
            // profile-pic의 src에 사진 데이터를 넣는것 //
        }

        // 사진 업로드하면 init, predict 함수 실행되도록 아래추가, 기존 버튼들은 제거
        reader.readAsDataURL(input.files[0]);
        init().then(()=>{
          console.log("hello");
          predict();
        });
    }
}


$(".file-upload").on('change', function(){
    readURL(this);
});

$(".upload-button").on('click', function() {
   $(".file-upload").click();
});
});

</script>
<!-- //codepen 가져온것 위 -->

<script type="text/javascript">
    // More API functions here:
    // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

    // the link to your model provided by Teachable Machine export panel
    const URL = "https://teachablemachine.withgoogle.com/models/uZLLr5oim/";

    let model, webcam, labelContainer, maxPredictions;

    // Load the image model and setup the webcam
    async function init() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        // load the model and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // or files from your local hard drive
        // Note: the pose library adds "tmImage" object to your window (window.tmImage)
        model = await tmImage.load(modelURL, metadataURL);
        maxPredictions = model.getTotalClasses();

        // Convenience function to setup a webcam
        // const flip = true; // whether to flip the webcam
        // webcam = new tmImage.Webcam(200, 200, flip); // width, height, flip
        // await webcam.setup(); // request access to the webcam
        // await webcam.play();
        // window.requestAnimationFrame(loop);

        // // append elements to the DOM
        // document.getElementById("webcam-container").appendChild(webcam.canvas);
        resultMessage = document.getElementById("result-message")

        labelContainer = document.getElementById("label-container");
        for (let i = 0; i < maxPredictions; i++) { // and class labels
            labelContainer.appendChild(document.createElement("div"));
        }
    }
// 웹캠에서 사진 업로드 방식으로 바꾸므로 loop 필요없어짐//
    // async function loop() {
    //     webcam.update(); // update the webcam frame
    //     await predict();
    //     window.requestAnimationFrame(loop);
    // }

    // run the webcam image through the image model
    async function predict() {
        // predict can take in an image, video or canvas html element
        var image = document.getElementById("face-image")
        const prediction = await model.predict(image, false);
        prediction.sort((a, b) => parseFloat(b.probability) - parseFloat(a.probability));
        

        // console.log(prediction[0].className);
        // console.log(prediction[1].className);
        // console.log(prediction[2].className);
        // console.log(prediction[3].className);
        // console.log(prediction[4].className);



        // 밑에는 가장확률 높은거 하나띄우기 위해 추가한 코드
        console.log(prediction[0].className);    
        var resultMessage;
        switch(prediction[0].className) {
            case "IU":
                  resultMessage = "IU"
                  break;
            case "Blackpink Jisoo":
                  resultMessage = "Blackpink Jisoo"
                  break;
            case "EXO Sehun":
                  resultMessage = "EXO Sehun"
                  break;
            case "BTS V":
                  resultMessage = "BTS V"
                  break;
            case "Blackpink Lisa":
                  resultMessage = "Blackpink Lisa"
                  break;
            case "Blackpink Jennie":
                  resultMessage = "Blackpink Jennie"
                  break;
            case "Blackpink Rose":
                  resultMessage = "Blackpink Rose"
                  break;
            // default:
            //       resultMessage = "Unknown"
            // 디폴트 메세지는 지움
        }                
        $('.result-message').html(resultMessage)



        for (let i = 0; i < maxPredictions; i++) {
            const classPrediction =
                prediction[i].className + ": " + prediction[i].probability.toFixed(2);
            labelContainer.childNodes[i].innerHTML = classPrediction;
        }

        
    }
</script>


</body>


</html>
